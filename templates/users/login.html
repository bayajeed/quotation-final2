{% extends 'base.html' %}

{% block title %}Login - Unikobazar{% endblock %}

{% block content %}
<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    /* ********** 1. Responsive & Centering Logic ********** */
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: #0f172a;
        min-height: 100vh;
        
        /* Centering the content on the screen */
        display: flex;
        justify-content: center;
        align-items: center;
        
        overflow: hidden;
        position: relative;
    }

    /* Animated Background Canvas */
    #bgCanvas {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 1;
    }

    /* Login Container */
    .login-container {
        position: relative;
        z-index: 10;
        background: rgba(30, 41, 59, 0.8);
        backdrop-filter: blur(20px);
        border-radius: 24px;
        padding: 50px 40px;
        width: 420px;
        
        /* Make container responsive for smaller screens */
        max-width: 90%; 
        
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5),
                    0 0 100px rgba(59, 130, 246, 0.2);
        border: 1px solid rgba(59, 130, 246, 0.3);
        animation: containerFloat 6s ease-in-out infinite;
    }

    @keyframes containerFloat {
        0%, 100% { transform: translateY(0px); }
        50% { transform: translateY(-10px); }
    }
    /* ********** End of Centering Logic ********** */

    .logo {
        text-align: center;
        margin-bottom: 35px;
    }

    .logo h1 {
        color: white;
        font-size: 36px;
        font-weight: 700;
        text-shadow: 0 0 30px rgba(59, 130, 246, 0.5);
        background: linear-gradient(135deg, #3b82f6 0%, #06b6d4 50%, #8b5cf6 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        animation: titleGlow 3s ease-in-out infinite;
    }

    @keyframes titleGlow {
        0%, 100% { filter: brightness(1); }
        50% { filter: brightness(1.3); }
    }

    .logo p {
        color: rgba(255, 255, 255, 0.6);
        font-size: 14px;
        margin-top: 8px;
    }

    .form-group {
        margin-bottom: 25px;
        position: relative;
    }

    .form-group label {
        display: block;
        color: rgba(255, 255, 255, 0.9);
        font-size: 14px;
        margin-bottom: 10px;
        font-weight: 500;
    }

    .form-group input {
        width: 100%;
        padding: 16px;
        border: 2px solid rgba(59, 130, 246, 0.3);
        background: rgba(30, 41, 59, 0.6);
        border-radius: 12px;
        color: white;
        font-size: 14px;
        transition: all 0.4s ease;
        position: relative;
    }
    
    .form-group input:focus {
        outline: none;
        border-color: rgba(138, 43, 226, 0.8);
        background: rgba(30, 30, 30, 0.8);
        box-shadow: 0 0 30px rgba(138, 43, 226, 0.3),
                    inset 0 0 20px rgba(138, 43, 226, 0.1);
        transform: translateY(-2px);
    }

    .input-glow {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 0;
        height: 2px;
        background: linear-gradient(90deg, #667eea, #764ba2, #f093fb);
        transition: width 0.4s ease;
    }

    .form-group input:focus ~ .input-glow {
        width: 100%;
    }

    .remember-forgot {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 28px;
    }

    .remember-me {
        display: flex;
        align-items: center;
        color: rgba(255, 255, 255, 0.8);
        font-size: 13px;
    }

    .remember-me input[type="checkbox"] {
        width: auto;
        margin-right: 8px;
        cursor: pointer;
        accent-color: #764ba2;
        /* Reset custom input styles for checkbox */
        padding: 0;
        border: initial;
        background: initial;
        border-radius: initial;
        color: initial;
        font-size: initial;
        transition: initial;
        position: initial;
        transform: initial;
        box-shadow: initial;
    }

    .forgot-password {
        color: rgba(138, 43, 226, 0.9);
        text-decoration: none;
        font-size: 13px;
        transition: all 0.3s ease;
        position: relative;
    }

    .login-btn {
        width: 100%;
        padding: 16px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
        background-size: 200% 200%;
        border: none;
        border-radius: 12px;
        color: white;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        box-shadow: 0 4px 20px rgba(138, 43, 226, 0.4);
        position: relative;
        overflow: hidden;
        animation: gradientShift 3s ease infinite;
    }
    /* ... (rest of CSS for button, divider, social login) ... */
    
    /* Cursor glow effect */
    .cursor-glow {
        position: fixed;
        width: 300px;
        height: 300px;
        border-radius: 50%;
        background: radial-gradient(circle, rgba(138, 43, 226, 0.15) 0%, transparent 70%);
        pointer-events: none;
        z-index: 2;
        transform: translate(-50%, -50%);
        transition: opacity 0.3s ease;
    }
    
    /* Added temporary styling for errorlist to be visible */
    .errorlist {
        color: #f093fb; 
        list-style-type: none; 
        padding: 5px 0 0 0; 
        font-size: 12px;
    }

</style>

<canvas id="bgCanvas"></canvas>
<div class="cursor-glow" id="cursorGlow"></div>
 
<div class="login-container">
    <div class="logo">
        <h1>Uniko Power</h1> 
        <p>Welcome back! Please login to your account</p>
    </div>

    <form method="post">
        {% csrf_token %} 

        {% if form.non_field_errors %}
            <div class="form-group">
                <ul class="errorlist" style="color: red;">
                    {% for error in form.non_field_errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            </div>
        {% endif %}

        <div class="form-group">
            <label for="{{ form.username.id_for_label }}">Username or Email</label>
            {{ form.username }} 
            <div class="input-glow"></div>
            {% if form.username.errors %}
            <ul class="errorlist">
                {% for error in form.username.errors %}
                    <li>{{ error }}</li>
                {% endfor %}
            </ul>{% endif %}
        </div>

        <div class="form-group">
            <label for="{{ form.password.id_for_label }}">Password</label>
            {{ form.password }}
            <div class="input-glow"></div>
            {% if form.password.errors %}<ul class="errorlist">{% for error in form.password.errors %}<li>{{ error }}</li>{% endfor %}</ul>{% endif %}
        </div>
        <button type="submit" class="login-btn" id="submitLoginBtn"><span>Login</span></button>
    </form>
    
</div>

<script>
    /*
    * All the complex JS for particle effects, wave effects, and cursor glow 
    * from your original design is included here and kept functional.
    */
    const canvas = document.getElementById('bgCanvas');
    const ctx = canvas.getContext('2d');
    
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    let mouseX = canvas.width / 2;
    let mouseY = canvas.height / 2;
    let particles = [];
    let connections = [];

    // Particle, Wave, and Animation logic (omitted for brevity, assume the full script is here)
    class Particle {
        // ... (rest of Particle class) ...
        constructor(x, y) {
            this.x = x || Math.random() * canvas.width;
            this.y = y || Math.random() * canvas.height;
            this.vx = (Math.random() - 0.5) * 1;
            this.vy = (Math.random() - 0.5) * 1;
            this.radius = Math.random() * 2 + 1;
            this.color = this.getRandomColor();
            this.life = 1;
            this.decay = Math.random() * 0.005 + 0.002;
        }

        getRandomColor() {
            const colors = [
                'rgba(102, 126, 234,',
                'rgba(118, 75, 162,',
                'rgba(240, 147, 251,'
            ];
            return colors[Math.floor(Math.random() * colors.length)];
        }
        
        update() {
            // Attraction to mouse
            const dx = mouseX - this.x;
            const dy = mouseY - this.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            if (distance < 200) {
                const force = (200 - distance) / 200;
                this.vx += (dx / distance) * force * 0.3;
                this.vy += (dy / distance) * force * 0.3;
            }

            // Apply velocity
            this.x += this.vx;
            this.y += this.vy;

            // Friction
            this.vx *= 0.98;
            this.vy *= 0.98;

            // Bounce off edges
            if (this.x < 0 || this.x > canvas.width) this.vx *= -1;
            if (this.y < 0 || this.y > canvas.height) this.vy *= -1;

            // Keep in bounds
            this.x = Math.max(0, Math.min(canvas.width, this.x));
            this.y = Math.max(0, Math.min(canvas.height, this.y));

            this.life -= this.decay;
        }

        draw() {
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
            ctx.fillStyle = this.color + this.life + ')';
            ctx.fill();

            // Glow effect
            ctx.shadowBlur = 20;
            ctx.shadowColor = this.color + this.life + ')';
            ctx.fill();
            ctx.shadowBlur = 0;
        }
    }
    
    class Wave {
        // ... (rest of Wave class) ...
        constructor() {
            this.y = Math.random() * canvas.height;
            this.length = canvas.width;
            this.amplitude = Math.random() * 50 + 30;
            this.frequency = Math.random() * 0.01 + 0.005;
            this.speed = Math.random() * 0.02 + 0.01;
            this.offset = Math.random() * Math.PI * 2;
            this.color = this.getRandomColor();
        }

        getRandomColor() {
            const colors = [
                'rgba(102, 126, 234, 0.1)',
                'rgba(118, 75, 162, 0.1)',
                'rgba(240, 147, 251, 0.1)'
            ];
            return colors[Math.floor(Math.random() * colors.length)];
        }

        update() {
            this.offset += this.speed;
        }

        draw() {
            ctx.beginPath();
            ctx.moveTo(0, this.y);

            for (let x = 0; x < canvas.width; x += 5) {
                const y = this.y + Math.sin(x * this.frequency + this.offset) * this.amplitude;
                ctx.lineTo(x, y);
            }

            ctx.strokeStyle = this.color;
            ctx.lineWidth = 2;
            ctx.stroke();
        }
    }
    // ... (End of Particle/Wave classes) ...

    // Initialize
    for (let i = 0; i < 100; i++) {
        particles.push(new Particle());
    }

    const waves = [];
    for (let i = 0; i < 5; i++) {
        waves.push(new Wave());
    }

    function animate() {
        ctx.fillStyle = 'rgba(10, 10, 10, 0.1)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        waves.forEach(wave => {
            wave.update();
            wave.draw();
        });

        particles.forEach((particle, index) => {
            particle.update();
            particle.draw();

            if (particle.life <= 0) {
                particles[index] = new Particle();
            }
        });

        for (let i = 0; i < particles.length; i++) {
            for (let j = i + 1; j < particles.length; j++) {
                const dx = particles[i].x - particles[j].x;
                const dy = particles[i].y - particles[j].y;
                const distance = Math.sqrt(dx * dx + dy * dy);

                if (distance < 120) {
                    const opacity = (1 - distance / 120) * 0.3;
                    ctx.beginPath();
                    ctx.moveTo(particles[i].x, particles[i].y);
                    ctx.lineTo(particles[j].x, particles[j].y);
                    ctx.strokeStyle = `rgba(138, 43, 226, ${opacity})`;
                    ctx.lineWidth = 1;
                    ctx.stroke();
                }
            }
        }

        requestAnimationFrame(animate);
    }

    animate();

    const cursorGlow = document.getElementById('cursorGlow');
    
    document.addEventListener('mousemove', (e) => {
        mouseX = e.clientX;
        mouseY = e.clientY;

        cursorGlow.style.left = e.clientX + 'px';
        cursorGlow.style.top = e.clientY + 'px';

        if (Math.random() > 0.85) {
            particles.push(new Particle(
                e.clientX + (Math.random() - 0.5) * 50,
                e.clientY + (Math.random() - 0.5) * 50
            ));
            
            if (particles.length > 150) {
                particles.shift();
            }
        }
    });

    window.addEventListener('resize', () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    });

    document.getElementById('submitLoginBtn').addEventListener('click', (e) => {
        const rect = e.currentTarget.getBoundingClientRect();
        const centerX = rect.left + rect.width / 2;
        const centerY = rect.top + rect.height / 2;

        for (let i = 0; i < 30; i++) {
            particles.push(new Particle(centerX, centerY));
        }
    });
</script>
{% endblock %}